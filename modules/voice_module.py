"""
–ú–æ–¥—É–ª—å –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–∏—ë–º–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –±–æ—Ç –æ–∂–∏–¥–∞–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏—Ç –µ–º—É –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø—Ä–∏—ë–º –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ.
–ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
–≠—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —É–¥–æ–±–Ω—ã–π –∫–∞–Ω–∞–ª –¥–ª—è –º–µ–Ω–µ–µ —Ñ–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏.
"""
class VoiceModule:
    def __init__(self, bot, is_enabled_cb):
        self.bot = bot
        self.is_enabled = is_enabled_cb
        self.await_voice = set()

    def handle(self, msg):
        if not self.is_enabled('voice_module'):
            return False

        if msg.text == "üé§ –ì–æ–ª–æ—Å–æ–≤–æ–µ":
            self.await_voice.add(msg.from_user.id)
            self.bot.send_message(msg.chat.id, "–ñ–¥—É –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!")
            return True

        if msg.from_user.id in self.await_voice:
            if getattr(msg, 'content_type', None) == "voice":
                self.await_voice.remove(msg.from_user.id)
                self.bot.send_message(msg.chat.id, "–ì–æ–ª–æ—Å–æ–≤–æ–µ –ø–æ–ª—É—á–µ–Ω–æ. (–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞)")
            else:
                self.bot.send_message(msg.chat.id, "–ñ–¥—É –∏–º–µ–Ω–Ω–æ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.")
            return True

        return False
